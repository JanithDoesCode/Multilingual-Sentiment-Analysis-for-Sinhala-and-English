# -*- coding: utf-8 -*-
"""eval_utils.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/10A8Aq2KQeFey01NHRjJgfdGAy0g2zqmn
"""

import torch
from sklearn.metrics import accuracy_score, f1_score, classification_report

device = torch.device("cuda" if torch.cuda.is_available() else "cpu")

def get_predictions(model, loader):
  model.eval()
  preds = []
  trues = []

  with torch.no_grad():
    for batch in loader:
      batch = {k: v.to(device) for k,v in batch.items()}
      labels = batch["labels"]

      outputs = model(**batch)
      logits = outputs.logits
      predictions = torch.argmax(logits, dim = 1)

      preds.extend(predictions.cpu().numpy())
      trues.extend(labels.cpu().numpy())

  return preds, trues